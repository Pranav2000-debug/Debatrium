    console.log("INTERCEPTOR HIT", {
      url: error.config?.url,
      status: error.response?.status,
      data: error.response?.data,
    });



    # üîç Auth + Refresh Token Debug Logs Playbook

Use these logs ONLY while debugging auth flows.
Remove them once behavior is verified.

---

## 1Ô∏è‚É£ AuthContext.jsx

### Purpose
- Verify auth resolution lifecycle
- Confirm when user + loading state change
- Detect premature redirects

### Where
Inside `AuthProvider`, top-level render

### Log
```js
console.log("AUTH STATE", { user, loading });
Expected
First render: { user: null, loading: true }

After refresh or success: { user: {...}, loading: false }

After real logout: { user: null, loading: false }

2Ô∏è‚É£ ProtectedRoutes.jsx
Purpose
Confirm route guard waits for auth

Ensure redirect only happens AFTER auth resolution

Where
At top of ProtectedRoutes component

Log
js
Copy code
console.log("PROTECTED ROUTES", { isAuthenticated, loading });
Expected
While resolving auth: loading: true

After refresh success: isAuthenticated: true

After refresh failure: redirect occurs

3Ô∏è‚É£ Axios Interceptor (response error handler)
Purpose
Confirm interceptor is triggered

Inspect error shape for refresh decision

Debug why refresh is / isn‚Äôt firing

Where
At top of interceptor error callback

Logs
js
Copy code
console.log("INTERCEPTOR HIT", {
  url: error.config?.url,
  status: error.response?.status,
});

console.log("ERROR SHAPE", error.response?.data);
Expected Flow
/users/me ‚Üí 401

Interceptor logs appear

Error code shows ACCESS_TOKEN_EXPIRED

4Ô∏è‚É£ Refresh Token Controller (backend)
Purpose
Confirm refresh endpoint is actually hit

Confirm cookies are received

Debug reuse / expiry logic

Where
First line inside refreshAccessToken

Log
js
Copy code
console.log("REFRESH CONTROLLER HIT", {
  refreshTokenPresent: !!req.cookies.refreshToken,
});
Expected
true when refresh should succeed

false only after logout / expiry

5Ô∏è‚É£ verifyJwt Middleware (backend)
Purpose
Confirm access token verification behavior

Ensure expiry throws correct error

Where
Inside catch block for JWT verification

Log
js
Copy code
console.log("ACCESS TOKEN ERROR", err.name);
Expected
TokenExpiredError when access token expires

6Ô∏è‚É£ Network Tab Checklist (Browser)
What to Check
/users/me returns 401 (not 200)

/auth/refresh-token is called once

/users/me is retried and returns 200

Cookies updated after refresh

üß† Debug Mental Model
If no interceptor logs ‚Üí request never fired

If no refresh logs ‚Üí 401 not thrown

If immediate redirect ‚Üí route guard fired too early

If 200 with user:null ‚Üí optional auth middleware used incorrectly